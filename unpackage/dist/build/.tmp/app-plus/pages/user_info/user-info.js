(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/user_info/user-info"],{3909:function(e,t,a){"use strict";a.r(t);var n=a("43ad"),s=a.n(n);for(var i in n)"default"!==i&&function(e){a.d(t,e,function(){return n[e]})}(i);t["default"]=s.a},"43ad":function(e,t,a){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a={data:function(){return{nickname:e.getStorageSync("login_key").nickname,avatar:e.getStorageSync("login_key").avatar,userId:e.getStorageSync("login_key").userId}},onLoad:function(){e.setNavigationBarTitle({title:"修改资料"})},methods:{uploadNickname:function(){var t=this,a=this;e.request({url:this.apiServer+"/user/nickname",method:"post",header:{"content-type":"application/x-www-form-urlencoded"},data:{userId:a.userId,nickname:a.newNickname},success:function(n){console.log(n.data),a.nickname=a.newNickname,e.request({url:t.apiServer+"/user/"+e.getStorageSync("login_key").userId,method:"GET",data:{userId:a.userId},header:{"content-type":"application/json"},success:function(t){0==t.data.code&&e.setStorageSync("login_key",{userId:t.data.data.id,nickname:t.data.data.nickname,avatar:t.data.data.avatar,token:t.data.data.token,login:!0})}})}})},showActionSheet:function(){var t=this;e.showActionSheet({itemList:["拍照","从相册选择"],success:function(a){console.log("选中了第"+(a.tapIndex+1)+"个按钮"),0==a.tapIndex&&e.chooseImage({count:1,sourceType:["camera"],success:function(a){e.saveImageToPhotosAlbum({filePath:a.tempFilePaths[0],success:function(){console.log("save success"),e.uploadFile({url:"http://192.168.43.99:8080/api/user/avatar",filePath:a.tempFilePaths[0],name:"file",formData:{userId:t.userId},success:function(e){console.log(e.data),t.avatar=e.data},complete:function(){console.log("save"),e.request({url:"http://192.168.43.99:8080/api/user/"+e.getStorageSync("login_key").userId,method:"GET",data:{userId:t.userId},header:{"content-type":"application/json"},success:function(t){console.log("save2"),0==t.data.code&&e.setStorageSync("login_key",{userId:t.data.data.id,nickname:t.data.data.nickname,avatar:t.data.data.avatar,token:t.data.data.token,login:!0})}})}})}})}}),1==a.tapIndex&&e.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["album"],success:function(a){console.log(JSON.stringify(a.tempFilePaths)),e.uploadFile({url:" http://192.168.43.99:8080/api/user/avatar",filePath:a.tempFilePaths[0],name:"file",formData:{userId:t.userId},success:function(e){console.log(e.data),t.avatar=e.data},complete:function(){console.log("save"),e.request({url:"http://192.168.43.99:8080/api/user/"+e.getStorageSync("login_key").userId,method:"GET",data:{userId:t.userId},header:{"content-type":"application/json"},success:function(t){console.log("save2"),0==t.data.code&&e.setStorageSync("login_key",{userId:t.data.data.id,nickname:t.data.data.nickname,avatar:t.data.data.avatar,token:t.data.data.token,login:!0})}})}})}})},fail:function(e){console.log(e.errMsg)}})}}};t.default=a}).call(this,a("649d")["default"])},"58eb":function(e,t,a){"use strict";var n=a("73f1"),s=a.n(n);s.a},"73f1":function(e,t,a){},"76be":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("view",{staticClass:"container"},[a("view",{staticClass:"list"},[a("view",{staticClass:"list-item list-item-heigher"},[a("view",{staticClass:"left"},[e._v("头像")]),a("view",{staticClass:"right"},[a("image",{staticClass:"avatar",attrs:{src:e.avatar,eventid:"52973665-0"},on:{tap:e.showActionSheet}})])]),a("view",{staticClass:"list-item list-item-heigher"},[a("view",{staticClass:"left"},[e._v("昵称")]),a("view",{staticClass:"right"},[e._v(e._s(e.nickname))])]),a("view",{staticClass:"list-item list-item-heigher"},[a("view",{staticClass:"right1"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.newNickname,expression:"newNickname"}],attrs:{type:"text",eventid:"52973665-1"},domProps:{value:e.newNickname},on:{input:function(t){t.target.composing||(e.newNickname=t.target.value)}}})]),a("view",{staticClass:"left"},[a("button",{staticClass:"green-btn",attrs:{eventid:"52973665-2"},on:{tap:e.uploadNickname}},[e._v("确定")])],1)])])])},s=[];a.d(t,"a",function(){return n}),a.d(t,"b",function(){return s})},"9f94":function(e,t,a){"use strict";a.r(t);var n=a("76be"),s=a("3909");for(var i in s)"default"!==i&&function(e){a.d(t,e,function(){return s[e]})}(i);a("58eb");var o=a("2877"),c=Object(o["a"])(s["default"],n["a"],n["b"],!1,null,null,null);t["default"]=c.exports},cb6e:function(e,t,a){"use strict";a("175f");var n=i(a("b0ce")),s=i(a("9f94"));function i(e){return e&&e.__esModule?e:{default:e}}Page((0,n.default)(s.default))}},[["cb6e","common/runtime","common/vendor"]]]);