(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/article_detail/article_detail"],{"4a22":function(t,e,a){},a305:function(t,e,a){"use strict";a.r(e);var i=a("faf8"),n=a.n(i);for(var c in i)"default"!==c&&function(t){a.d(e,t,function(){return i[t]})}(c);e["default"]=n.a},b5bf:function(t,e,a){"use strict";a.r(e);var i=a("e2ee"),n=a("a305");for(var c in n)"default"!==c&&function(t){a.d(e,t,function(){return n[t]})}(c);a("f5a1");var r=a("2877"),s=Object(r["a"])(n["default"],i["a"],i["b"],!1,null,null,null);e["default"]=s.exports},e2ee:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("view",{staticClass:"container"},[a("text",{staticClass:"article-title"},[t._v(t._s(t.article.title))]),a("view",{staticClass:"article-info"},[a("image",{staticClass:"article-avatar",attrs:{src:t.article.avatar}}),a("text",{staticClass:"article-writer"},[t._v(t._s(t.article.nickname))]),a("text",{staticClass:"info-text"},[t._v(t._s(t.article.createTime))]),t.userId==t.article.uId||t.followed?t._e():a("button",{staticClass:"green",attrs:{eventid:"64394e51-0"},on:{tap:t.follow}},[t._v("关注")]),t.userId!=t.article.uId&&t.followed?a("button",{staticClass:"green1",attrs:{eventid:"64394e51-1"},on:{tap:t.cancelFollow}},[t._v("取消")]):t._e()],1),a("view",{staticClass:"grace-text",staticStyle:{"margin-top":"10px"}},[a("rich-text",{attrs:{nodes:t.article.content,bindtap:"tap",mpcomid:"64394e51-0"}})],1),t.liked?t._e():a("button",{staticClass:"green",attrs:{eventid:"64394e51-2"},on:{tap:t.likeArticke}},[t._v("收藏")]),t.liked?a("button",{staticClass:"green1",attrs:{eventid:"64394e51-3"},on:{tap:t.cancelLike}},[t._v("取消")]):t._e(),a("text",{staticClass:"info-text2"},[t._v("评论"+t._s(t.comments.length))]),t._l(t.comments,function(e,i){return a("view",{key:i,staticClass:"comment-item"},[a("view",{staticClass:"left"},[a("image",{staticClass:"avatar small",attrs:{src:e.avatar}})]),a("view",{staticClass:"right"},[a("text",[t._v(t._s(e.nickname))]),a("text",[t._v(t._s(e.content))]),a("view",[a("text",{staticStyle:{"margin-right":"10px"}},[t._v(t._s(t.comments.length-i)+"楼")]),a("text",{staticClass:"time"},[t._v(t._s(e.commentTime))])])])])}),a("input",{directives:[{name:"model",rawName:"v-model",value:t.content,expression:"content"}],staticClass:"uni-input comment-box",attrs:{type:"text",placeholder:"写下你的评论",required:"required",eventid:"64394e51-4"},domProps:{value:t.content},on:{input:function(e){e.target.composing||(t.content=e.target.value)}}}),a("button",{staticClass:"green-btn",attrs:{eventid:"64394e51-5"},on:{tap:t.send}},[t._v("提交")])],2)},n=[];a.d(e,"a",function(){return i}),a.d(e,"b",function(){return n})},ed7d:function(t,e,a){"use strict";a("175f");var i=c(a("b0ce")),n=c(a("b5bf"));function c(t){return t&&t.__esModule?t:{default:t}}Page((0,i.default)(n.default))},f5a1:function(t,e,a){"use strict";var i=a("4a22"),n=a.n(i);n.a},faf8:function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a={data:function(){return{article:{aId:0,uId:0,title:"",content:"",avatar:"",nickname:"",createTime:""},comments:[],content:"",userId:t.getStorageSync("login_key").userId,followed:!1,liked:!1}},onLoad:function(t){this.article.aId=t.aId},onShow:function(){this.getArticle()},onPullDownRefresh:function(){this.getArticle()},methods:{likeArticke:function(){var e=this;t.request({url:this.apiServer+"/like/add",method:"POST",header:{"content-type":"application/x-www-form-urlencoded"},data:{aId:this.article.aId,uId:this.userId},success:function(a){t.showToast({title:"收藏成功"}),e.liked=!0}})},cancelLike:function(){var e=this;t.request({url:this.apiServer+"/like/cancel",method:"POST",header:{"content-type":"application/x-www-form-urlencoded"},data:{aId:this.article.aId,uId:this.userId},success:function(t){e.liked=!1}})},getArticle:function(){var e=this,a=this;t.request({url:this.apiServer+"/article/"+this.article.aId,method:"GET",header:{"content-type":"application/x-www-form-urlencoded"},data:{userId:this.userId},success:function(t){a.article.aId=t.data.data.article.id,a.article.uId=t.data.data.article.uid,a.article.title=t.data.data.article.title,a.article.content=t.data.data.article.content,a.article.nickname=t.data.data.article.nickname,a.article.avatar=t.data.data.article.avatar,a.article.createTime=t.data.data.article.createTime,a.comments=t.data.data.comments,a.article.createTime=e.handleTime(a.article.createTime);for(var i=0;i<a.comments.length;i++)a.comments[i].commentTime=e.handleTime(a.comments[i].commentTime);"已关注"===t.data.data.followed&&(a.followed=!0),"喜欢"===t.data.data.liked&&(a.liked=!0)},complete:function(){t.stopPullDownRefresh()}})},handleTime:function(t){var e=new Date(t),a=e.getFullYear(),i=e.getMonth()+1,n=e.getDate()<10?"0"+e.getDate():""+e.getDate(),c=e.getHours()<10?"0"+e.getHours():""+e.getHours(),r=e.getMinutes()<10?"0"+e.getMinutes():""+e.getMinutes(),s=e.getSeconds()<10?"0"+e.getSeconds():""+e.getSeconds();return a+"-"+i+"-"+n+" "+c+":"+r+":"+s},send:function(){var e=this;console.log("评论人编号："+this.userId+",文章编号："+this.article.aId+"，评论内容："+this.content),t.request({url:this.apiServer+"/comment/add",method:"POST",header:{"content-type":"application/x-www-form-urlencoded"},data:{aId:this.article.aId,uId:this.userId,content:this.content},success:function(a){0===a.data.code&&(t.showToast({title:"评论成功"}),e.getArticle(),e.content="")}})},follow:function(){var e=this;t.request({url:this.apiServer+"/follow/add",method:"POST",header:{"content-type":"application/x-www-form-urlencoded"},data:{fromUId:this.userId,toUId:this.article.uId},success:function(a){0===a.data.code&&(t.showToast({title:"关注成功"}),e.followed=!0)}})},cancelFollow:function(){var e=this;t.request({url:this.apiServer+"/follow/cancel",method:"POST",header:{"content-type":"application/x-www-form-urlencoded"},data:{fromUId:this.userId,toUId:this.article.uId},success:function(a){0===a.data.code&&(t.showToast({title:"已取消关注"}),e.followed=!1)}})}}};e.default=a}).call(this,a("649d")["default"])}},[["ed7d","common/runtime","common/vendor"]]]);